[W Context.cpp:69] Warning: torch.set_deterministic is in beta, and its design and  functionality may change in the future. (function operator())
Global seed set to 2
[WARNING] modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] freiburg - train 230 | val 136 | test 136
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[INFO] SORD ranks: [0 1 2 3 4 5]
[INFO] SORD using L1 distance
[INFO] SORD ranks: [0 1 2 3 4 5]
[INFO] SORD using L1 distance
/home/robotlab/rob10/learning-driveability-heatmaps/models/pytorch-unet-segnet/env/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
[INFO] Distance ranks [0, 1, 2]
[INFO] Distances: mistakes from 1 to 2
[INFO] IoU labels: [0, 1, 2, 3, 4, 5]
[INFO] Confusion matrix labels: [0, 1, 2]
[INFO] IoU labels: [0, 1, 2]
[INFO] 2021-04-05 22-07-freiburg-c6-kl-0,1,2-rgb
[WARNING] Testing phase
GPU available: False, used: False
TPU available: None, using: 0 TPU cores
Global seed set to 2
[WARNING] modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] freiburg - train 230 | val 136 | test 136
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[INFO] SORD ranks: [0 1 2 3 4 5]
[INFO] SORD using L1 distance
[INFO] SORD ranks: [0 1 2 3 4 5]
[INFO] SORD using L1 distance
[INFO] Distance ranks [0, 1, 2]
[INFO] Distances: mistakes from 1 to 2
[INFO] IoU labels: [0, 1, 2, 3, 4, 5]
[INFO] Confusion matrix labels: [0, 1, 2]
[INFO] IoU labels: [0, 1, 2]
[INFO] 2021-04-05 22-07-freiburg-c6-kl-0,1,2-rgb
Namespace(augment=False, bs=16, dataset='freiburg', debug=True, dist='l1', full_dataset=False, gpus=0, loss='kl', loss_weight=False, lr=None, max_epochs=1000, modalities='rgb', mode='convert', momentum=None, num_classes=6, optim=None, orig_dataset='freiburg', prefix=None, ranks='0,1,2', save=False, test_checkpoint='lightning_logs/2021-03-31 08-51-freiburg-c6-kl-rgb-epoch=673-val_loss=0.2363.ckpt', test_samples=None, train=False, train_checkpoint='lightning_logs/last.ckpt', update_output_layer=False, viz=False, workers=10)
b396-759 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/train
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
2021-04-05 22-07-freiburg-c6-kl-0,1,2-rgb
b396-759 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/train
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
Testing: 0it [00:00, ?it/s][DEBUG] CM: [[1207733   14985      85]
 [  44993  388033    2074]
 [   4489   26104  154704]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.9042010816506795 | macro 0.8631388108335436
[DEBUG] MaskedIoU per class [0.94926294 0.81487183 0.82528167]
[DEBUG] L1 distance tensor([1., 1., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.0000, 0.0000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.0000, 0.0000, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  11%|█         | 1/9 [00:13<01:48, 13.57s/it][DEBUG] CM: [[1208714   24518      38]
 [  44651  417668    2187]
 [   1766   24134  119524]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 0 0 0]
[DEBUG] MaskedIoU micro 0.8997224418112089 | macro 0.8559900665265396
[DEBUG] MaskedIoU per class [0.94453878 0.81391696 0.80951446]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  22%|██▏       | 2/9 [00:25<01:26, 12.35s/it][DEBUG] CM: [[1184942   16266      21]
 [  63108  422604    1685]
 [   2888   33749  117937]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 0 0 0]
[DEBUG] MaskedIoU micro 0.8799367846777808 | macro 0.8253630032942416
[DEBUG] MaskedIoU per class [0.93506836 0.78636875 0.75465191]
[DEBUG] L1 distance tensor([2., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000])
Testing:  33%|███▎      | 3/9 [00:36<01:11, 11.97s/it][DEBUG] CM: [[1170331   34372      25]
 [  67808  425501    1560]
 [   1862   30135  111606]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.862794737847417 | macro 0.8159036595972754
[DEBUG] MaskedIoU per class [0.91834027 0.76067082 0.76869989]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  44%|████▍     | 4/9 [00:48<00:58, 11.79s/it][DEBUG] CM: [[1185164   18720      67]
 [  43751  402754    2163]
 [   1363   33058  156160]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.8979345340267989 | macro 0.8545144525864403
[DEBUG] MaskedIoU per class [0.94884093 0.80479013 0.8099123 ]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  56%|█████▌    | 5/9 [00:59<00:46, 11.75s/it][DEBUG] CM: [[1111184   13955      32]
 [  35506  546905    2120]
 [    748   27020  105730]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.9174224649052498 | macro 0.8701714767754097
[DEBUG] MaskedIoU per class [0.95674193 0.87434013 0.77943236]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  67%|██████▋   | 6/9 [01:11<00:34, 11.66s/it][DEBUG] CM: [[1186130   17539     123]
 [  42360  436095    2526]
 [   1935   35472  121020]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.8971209193296469 | macro 0.8394501079358787
[DEBUG] MaskedIoU per class [0.95035843 0.81666954 0.75132236]
[DEBUG] L1 distance tensor([2., 1., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 1., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.0000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.0000, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  78%|███████▊  | 7/9 [01:22<00:23, 11.62s/it][DEBUG] CM: [[1123477   26423      24]
 [  57813  487326    2817]
 [   1527   33884  109909]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 0 0 0]
[DEBUG] MaskedIoU micro 0.8753739148837455 | macro 0.8240187878266033
[DEBUG] MaskedIoU per class [0.9290585  0.80117646 0.7418214 ]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  89%|████████▉ | 8/9 [01:34<00:11, 11.58s/it][DEBUG] CM: [[598837   8733      3]
 [ 22778 214860    740]
 [  1528  10545  63576]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 0 1 0]
[DEBUG] MaskedIoU micro 0.9082187370267111 | macro 0.8712815508041993
[DEBUG] MaskedIoU per class [0.94770834 0.83390257 0.83223374]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing: 100%|██████████| 9/9 [01:39<00:00,  9.74s/it][DEBUG] CM - tensor([[9976512,  175511,     418],
        [ 422768, 3741746,   17872],
        [  18106,  254101, 1060166]])
[INFO] CM IoU - tensor([94.1774, 81.1307, 78.4923])
[INFO] precision tensor([95.7679, 89.7009, 98.3041], dtype=torch.float64) (94.59095449402261) | recall tensor([98.2671, 89.4644, 79.5698], dtype=torch.float64) (89.1004247538111)
Testing: 100%|██████████| 9/9 [01:40<00:00, 11.12s/it]
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'acc': 0.9432715773582458,
 'cm': 0.0,
 'dist_l1': 0.01042107306420803,
 'dist_l2': 0.01563161052763462,
 'test_iou': 0.8927783966064453}
--------------------------------------------------------------------------------
