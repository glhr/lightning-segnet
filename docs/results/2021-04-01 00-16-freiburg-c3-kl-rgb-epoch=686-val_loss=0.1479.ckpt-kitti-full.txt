[W Context.cpp:69] Warning: torch.set_deterministic is in beta, and its design and  functionality may change in the future. (function operator())
Global seed set to 2
[WARNING] modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] kitti - train 200 | val 200 | test 200
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
/home/robotlab/rob10/learning-driveability-heatmaps/models/pytorch-unet-segnet/env/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
[INFO] Distance ranks [0, 1, 2]
[INFO] Distances: mistakes from 1 to 2
[INFO] IoU labels: [0, 1, 2]
[INFO] Confusion matrix labels: [0, 1, 2]
[INFO] IoU labels: [0, 1, 2]
[INFO] 2021-04-05 22-19-kitti-c3-kl-0,1,2-rgb
[WARNING] Testing phase
GPU available: False, used: False
TPU available: None, using: 0 TPU cores
Global seed set to 2
[WARNING] modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] kitti - train 200 | val 200 | test 200
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
[INFO] Distance ranks [0, 1, 2]
[INFO] Distances: mistakes from 1 to 2
[INFO] IoU labels: [0, 1, 2]
[INFO] Confusion matrix labels: [0, 1, 2]
[INFO] IoU labels: [0, 1, 2]
[INFO] 2021-04-05 22-19-kitti-c3-kl-0,1,2-rgb
Namespace(augment=False, bs=16, dataset='kitti', debug=True, dist='l1', full_dataset=True, gpus=0, loss='kl', loss_weight=False, lr=None, max_epochs=1000, modalities='rgb', mode='affordances', momentum=None, num_classes=3, optim=None, orig_dataset='freiburg', prefix=None, ranks='0,1,2', save=False, test_checkpoint='lightning_logs/2021-04-01 00-16-freiburg-c3-kl-rgb-epoch=686-val_loss=0.1479.ckpt', test_samples=None, train=False, train_checkpoint='lightning_logs/last.ckpt', update_output_layer=False, viz=False, workers=10)
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
2021-04-05 22-19-kitti-c3-kl-0,1,2-rgb
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
Testing: 0it [00:00, ?it/s][DEBUG] CM: [[1102601   36521     358]
 [  91630  153465    7892]
 [  84393  333154   32763]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5377458824020278 | macro 0.38535759966193583
[DEBUG] MaskedIoU per class [0.83815924 0.24646598 0.07144758]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:   8%|▊         | 1/13 [00:16<03:12, 16.04s/it][DEBUG] CM: [[1077199   32224     199]
 [ 119604  155512    6278]
 [  58454  363801   29881]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 0 0 0]
[DEBUG] MaskedIoU micro 0.5209331801798234 | macro 0.37708769004984594
[DEBUG] MaskedIoU per class [0.83654246 0.22956545 0.06515515]
[DEBUG] L1 distance tensor([2., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000])
Testing:  15%|█▌        | 2/13 [00:29<02:37, 14.31s/it][DEBUG] CM: [[1072309   32338     423]
 [ 103317  217422     362]
 [  51667  335649   29687]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 2 2 2], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5574385385288115 | macro 0.4125271240038455
[DEBUG] MaskedIoU per class [0.85100242 0.31552138 0.07105757]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  23%|██▎       | 3/13 [00:42<02:19, 13.98s/it][DEBUG] CM: [[1086480   50839     508]
 [ 102473  155795    3337]
 [  74780  344914   24024]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5232638333620523 | macro 0.3722831286369521
[DEBUG] MaskedIoU per class [0.82617027 0.23700176 0.05367736]
[DEBUG] L1 distance tensor([1., 1., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.0000, 0.0000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.0000, 0.0000, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  31%|███       | 4/13 [00:56<02:04, 13.88s/it][DEBUG] CM: [[1094476   52351     320]
 [  98978  238699    4733]
 [  37232  268934   47289]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 0 0 0]
[DEBUG] MaskedIoU micro 0.5987543156543312 | macro 0.4481264558999645
[DEBUG] MaskedIoU per class [0.85282271 0.35965165 0.13190501]
[DEBUG] L1 distance tensor([2., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000])
Testing:  38%|███▊      | 5/13 [01:08<01:45, 13.23s/it][DEBUG] CM: [[1094915   57744     915]
 [  87107  184568    6184]
 [  59889  313091   38494]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5566164393917318 | macro 0.40612015386956873
[DEBUG] MaskedIoU per class [0.84187318 0.28452244 0.09196484]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  46%|████▌     | 6/13 [01:20<01:30, 12.88s/it][DEBUG] CM: [[1156887   36292     235]
 [  66488  118874    4038]
 [  68217  351777   40386]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5552798217565218 | macro 0.3879472471857266
[DEBUG] MaskedIoU per class [0.87107179 0.20585347 0.08691647]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  54%|█████▍    | 7/13 [01:32<01:15, 12.56s/it][DEBUG] CM: [[1120847   60274     526]
 [  96235  159379    3894]
 [  60654  299347   41991]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 0 0 0]
[DEBUG] MaskedIoU micro 0.5592952344614833 | macro 0.3993712146911846
[DEBUG] MaskedIoU per class [0.83736784 0.25742454 0.10332126]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  62%|██████▏   | 8/13 [01:44<01:01, 12.38s/it][DEBUG] CM: [[1109038   49069     356]
 [  89610  191765     969]
 [  52722  333571   15715]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5557010390390998 | macro 0.39330765566518067
[DEBUG] MaskedIoU per class [0.85258477 0.28837536 0.03896284]
[DEBUG] L1 distance tensor([2., 2., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.0000,  ..., 0.0000, 0.0000, 0.0000])
Testing:  69%|██████▉   | 9/13 [01:56<00:49, 12.28s/it][DEBUG] CM: [[1122510   32450       8]
 [ 119005  163639    3479]
 [  77413  309157   15490]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5458377137566188 | macro 0.37650505408499196
[DEBUG] MaskedIoU per class [0.8306361  0.26068373 0.03819533]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  77%|███████▋  | 10/13 [02:08<00:36, 12.26s/it][DEBUG] CM: [[1108786   41306     320]
 [  87485  155940     359]
 [  65388  357319   26118]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5389299757264326 | macro 0.38386969724626874
[DEBUG] MaskedIoU per class [0.8507625  0.24274255 0.05810404]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  85%|████████▍ | 11/13 [02:22<00:25, 12.59s/it][DEBUG] CM: [[1136384   33291     476]
 [  63588  138952     793]
 [  89626  366352   13630]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5376924418221455 | macro 0.3726991897169632
[DEBUG] MaskedIoU per class [0.85870792 0.23044367 0.02894599]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  92%|█████████▏| 12/13 [02:35<00:12, 12.64s/it][DEBUG] CM: [[574216  18973     97]
 [ 36800  61130    175]
 [ 35542 178110  16524]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5472086791844629 | macro 0.38048673751095635
[DEBUG] MaskedIoU per class [0.86266804 0.20708836 0.07170381]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing: 100%|██████████| 13/13 [02:41<00:00, 10.82s/it][DEBUG] CM - tensor([[13856648,   533672,     4741],
        [ 1162320,  2095140,    42493],
        [  815977,  4155176,   371992]])
[INFO] CM IoU - tensor([84.6292, 26.2260,  6.9010])
[INFO] precision tensor([87.5068, 30.8836, 88.7330], dtype=torch.float64) (69.04113793978203) | recall tensor([96.2597, 63.4900,  6.9620], dtype=torch.float64) (55.57059215083958)
Testing: 100%|██████████| 13/13 [02:41<00:00, 12.44s/it]
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'acc': 0.7085539698600769,
 'cm': 0.0,
 'dist_l1': 0.061116449534893036,
 'dist_l2': 0.09167467057704926,
 'test_iou': 0.5488874316215515}
--------------------------------------------------------------------------------
