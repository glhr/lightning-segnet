[W Context.cpp:69] Warning: torch.set_deterministic is in beta, and its design and  functionality may change in the future. (function operator())
Global seed set to 2
[WARNING] modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] freiburg - train 230 | val 136 | test 136
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
/home/robotlab/rob10/learning-driveability-heatmaps/models/pytorch-unet-segnet/env/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
[INFO] Distance ranks [0, 1, 2]
[INFO] Distances: mistakes from 1 to 2
[INFO] IoU labels: [0, 1, 2]
[INFO] Confusion matrix labels: [0, 1, 2]
[INFO] IoU labels: [0, 1, 2]
[INFO] 2021-04-05 22-14-freiburg-c3-kl-0,1,2-rgb
[WARNING] Testing phase
GPU available: False, used: False
TPU available: None, using: 0 TPU cores
Global seed set to 2
[WARNING] modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[WARNING] freiburg - train 230 | val 136 | test 136
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
[INFO] Distance ranks [0, 1, 2]
[INFO] Distances: mistakes from 1 to 2
[INFO] IoU labels: [0, 1, 2]
[INFO] Confusion matrix labels: [0, 1, 2]
[INFO] IoU labels: [0, 1, 2]
[INFO] 2021-04-05 22-14-freiburg-c3-kl-0,1,2-rgb
Namespace(augment=False, bs=16, dataset='freiburg', debug=True, dist='l1', full_dataset=False, gpus=0, loss='kl', loss_weight=False, lr=None, max_epochs=1000, modalities='rgb', mode='affordances', momentum=None, num_classes=3, optim=None, orig_dataset='freiburg', prefix=None, ranks='0,1,2', save=False, test_checkpoint='lightning_logs/2021-04-01 00-16-freiburg-c3-kl-rgb-epoch=686-val_loss=0.1479.ckpt', test_samples=None, train=False, train_checkpoint='lightning_logs/last.ckpt', update_output_layer=False, viz=False, workers=10)
b396-759 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/train
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
2021-04-05 22-14-freiburg-c3-kl-0,1,2-rgb
b396-759 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/train
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
Testing: 0it [00:00, ?it/s][DEBUG] CM: [[1207625   15135      43]
 [  32712  400084    2304]
 [   2892   40078  142327]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.9037742903710253 | macro 0.8447057829051384
[DEBUG] MaskedIoU per class [0.95964581 0.81597673 0.75849481]
[DEBUG] L1 distance tensor([1., 1., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.0000, 0.0000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.0000, 0.0000, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  11%|█         | 1/9 [00:15<02:04, 15.56s/it][DEBUG] CM: [[1216233   17002      35]
 [  37284  424093    3129]
 [    722   28094  116608]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 0 0 0]
[DEBUG] MaskedIoU micro 0.9105804403912793 | macro 0.8578936369329137
[DEBUG] MaskedIoU per class [0.95670256 0.83220435 0.78477401]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  22%|██▏       | 2/9 [00:27<01:32, 13.16s/it][DEBUG] CM: [[1189771   11436      22]
 [  47557  437169    2671]
 [   1493   26340  126741]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.9073647022665995 | macro 0.8633099772546391
[DEBUG] MaskedIoU per class [0.9516044  0.83242855 0.80589698]
[DEBUG] L1 distance tensor([2., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000])
Testing:  33%|███▎      | 3/9 [00:38<01:14, 12.41s/it][DEBUG] CM: [[1173909   30774      45]
 [  67161  426267    1441]
 [    928   30556  112119]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.8673778750370421 | macro 0.8204817271351605
[DEBUG] MaskedIoU per class [0.92229205 0.76639296 0.77276017]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  44%|████▍     | 4/9 [00:49<01:00, 12.01s/it][DEBUG] CM: [[1190514   13368      69]
 [  38073  407755    2840]
 [   1577   36443  152561]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.9045552472914955 | macro 0.8545933034231142
[DEBUG] MaskedIoU per class [0.95731187 0.81799835 0.78846969]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  56%|█████▌    | 5/9 [01:01<00:47, 11.86s/it][DEBUG] CM: [[1113067   12049      55]
 [  32544  548266    3721]
 [    368   23848  109282]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.9242242736006389 | macro 0.8803018310690099
[DEBUG] MaskedIoU per class [0.96112887 0.88368997 0.79608666]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  67%|██████▋   | 6/9 [01:13<00:35, 11.83s/it][DEBUG] CM: [[1186835   16875      82]
 [  35318  442801    2862]
 [    997   41086  116344]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.8997948897661331 | macro 0.8332087294041429
[DEBUG] MaskedIoU per class [0.95704242 0.8216116  0.72097217]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  78%|███████▊  | 7/9 [01:24<00:23, 11.75s/it][DEBUG] CM: [[1123498   26396      30]
 [  52937  491329    3690]
 [    864   30716  113740]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 0 0 0]
[DEBUG] MaskedIoU micro 0.8828980817056409 | macro 0.836174889666229
[DEBUG] MaskedIoU per class [0.93335106 0.81202278 0.76315083]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  89%|████████▉ | 8/9 [01:36<00:11, 11.64s/it][DEBUG] CM: [[598147   9421      5]
 [ 19994 215678   2706]
 [   257   8240  67152]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 0 0 0]
[DEBUG] MaskedIoU micro 0.9155642714838452 | macro 0.8840206941344215
[DEBUG] MaskedIoU per class [0.95273038 0.84236386 0.85696784]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing: 100%|██████████| 9/9 [01:41<00:00,  9.78s/it][DEBUG] CM - tensor([[9999599,  152456,     386],
        [ 363580, 3793442,   25364],
        [  10098,  265401, 1056874]])
[INFO] CM IoU - tensor([94.9980, 82.4618, 77.8187])
[INFO] precision tensor([96.3977, 90.0777, 97.6215], dtype=torch.float64) (94.69897362471139) | recall tensor([98.4945, 90.7004, 79.3227], dtype=torch.float64) (89.50588021079278)
Testing: 100%|██████████| 9/9 [01:42<00:00, 11.34s/it]
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'acc': 0.9478346705436707,
 'cm': 0.0,
 'dist_l1': 0.006413919385522604,
 'dist_l2': 0.009620878845453262,
 'test_iou': 0.9009825587272644}
--------------------------------------------------------------------------------
