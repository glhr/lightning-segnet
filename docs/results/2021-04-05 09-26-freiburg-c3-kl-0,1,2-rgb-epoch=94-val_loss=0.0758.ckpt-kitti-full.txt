[W Context.cpp:69] Warning: torch.set_deterministic is in beta, and its design and  functionality may change in the future. (function operator())
Global seed set to 2
[WARNING] modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] kitti - train 200 | val 200 | test 200
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
/home/robotlab/rob10/learning-driveability-heatmaps/models/pytorch-unet-segnet/env/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
[INFO] Distance ranks [0, 1, 2]
[INFO] Distances: mistakes from 1 to 2
[INFO] IoU labels: [0, 1, 2]
[INFO] Confusion matrix labels: [0, 1, 2]
[INFO] IoU labels: [0, 1, 2]
[INFO] 2021-04-05 23-07-kitti-c3-kl-0,1,2-rgb
[WARNING] Testing phase
GPU available: False, used: False
TPU available: None, using: 0 TPU cores
Global seed set to 2
[WARNING] modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] kitti - train 200 | val 200 | test 200
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
[INFO] SORD ranks: [0, 1, 2]
[INFO] SORD using L1 distance
[INFO] Distance ranks [0, 1, 2]
[INFO] Distances: mistakes from 1 to 2
[INFO] IoU labels: [0, 1, 2]
[INFO] Confusion matrix labels: [0, 1, 2]
[INFO] IoU labels: [0, 1, 2]
[INFO] 2021-04-05 23-07-kitti-c3-kl-0,1,2-rgb
Namespace(augment=False, bs=16, dataset='kitti', debug=True, dist='l1', full_dataset=True, gpus=0, loss='kl', loss_weight=False, lr=None, max_epochs=1000, modalities='rgb', mode='affordances', momentum=None, num_classes=3, optim=None, orig_dataset='freiburg', prefix=None, ranks='0,1,2', save=False, test_checkpoint='lightning_logs/2021-04-05 09-26-freiburg-c3-kl-0,1,2-rgb-epoch=94-val_loss=0.0758.ckpt', test_samples=None, train=False, train_checkpoint='lightning_logs/last.ckpt', update_output_layer=False, viz=False, workers=10)
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
2021-04-05 23-07-kitti-c3-kl-0,1,2-rgb
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
Testing: 0it [00:00, ?it/s][DEBUG] CM: [[1112972   26291     217]
 [ 101500  134528   16959]
 [  87138  283258   79914]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5629072065271782 | macro 0.41603220134531216
[DEBUG] MaskedIoU per class [0.83800686 0.23914558 0.17094416]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:   8%|▊         | 1/13 [00:14<02:56, 14.69s/it][DEBUG] CM: [[1090168   17933    1521]
 [ 134303  138514    8577]
 [  79017  276269   96850]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 1 1 0]
[DEBUG] MaskedIoU micro 0.5614824303236399 | macro 0.4247395369094617
[DEBUG] MaskedIoU per class [0.82404822 0.24064448 0.20952591]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  15%|█▌        | 2/13 [00:26<02:22, 12.95s/it][DEBUG] CM: [[1089061   15240     769]
 [ 155705  162432    2964]
 [  84449  249479   83075]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 2 2 2], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5674714471591731 | macro 0.42810014757603493
[DEBUG] MaskedIoU per class [0.80957595 0.27727288 0.19745161]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  23%|██▎       | 3/13 [00:38<02:03, 12.39s/it][DEBUG] CM: [[1111695   24609    1523]
 [ 127188  125365    9052]
 [ 103479  264831   75408]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5528900107505502 | macro 0.40194769736802866
[DEBUG] MaskedIoU per class [0.8123492  0.22750411 0.16598979]
[DEBUG] L1 distance tensor([1., 1., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.0000, 0.0000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.0000, 0.0000, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  31%|███       | 4/13 [00:49<01:49, 12.12s/it][DEBUG] CM: [[1121835   25171     141]
 [ 136674  200059    5677]
 [  76597  180883   95975]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 0 0 0]
[DEBUG] MaskedIoU micro 0.6251199763684581 | macro 0.4855080778153507
[DEBUG] MaskedIoU per class [0.82462523 0.36476232 0.26713669]
[DEBUG] L1 distance tensor([2., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000])
Testing:  38%|███▊      | 5/13 [01:01<01:35, 11.98s/it][DEBUG] CM: [[1108902   44166     506]
 [ 126204  135853   15802]
 [  74687  206679  130108]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5949338605621668 | macro 0.45993380746831347
[DEBUG] MaskedIoU per class [0.81870111 0.25695474 0.30414557]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  46%|████▌     | 6/13 [01:13<01:22, 11.81s/it][DEBUG] CM: [[1160242   29069    4103]
 [  77055  100895   11450]
 [ 106114  254845   99421]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5849774059153077 | macro 0.42163541025646906
[DEBUG] MaskedIoU per class [0.84284202 0.21316716 0.20889705]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  54%|█████▍    | 7/13 [01:26<01:13, 12.21s/it][DEBUG] CM: [[1141334   39907     406]
 [ 120269  128162   11077]
 [  80622  211866  109504]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 0 0 0]
[DEBUG] MaskedIoU micro 0.5976698244783716 | macro 0.4470140120659097
[DEBUG] MaskedIoU per class [0.82553536 0.25066842 0.26483826]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  62%|██████▏   | 8/13 [01:38<01:01, 12.29s/it][DEBUG] CM: [[1126340   31461     662]
 [ 115092  164889    2363]
 [  72067  243864   86077]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5966692717313514 | macro 0.4484114316065939
[DEBUG] MaskedIoU per class [0.83704042 0.29567539 0.21251849]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  69%|██████▉   | 9/13 [01:50<00:49, 12.27s/it][DEBUG] CM: [[1142071   12859      38]
 [ 133699  137722   14702]
 [ 127787  205273   69000]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.577021521628366 | macro 0.4149851929185033
[DEBUG] MaskedIoU per class [0.8062888  0.27311975 0.16554702]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  77%|███████▋  | 10/13 [02:04<00:37, 12.62s/it][DEBUG] CM: [[1133334   17075       3]
 [ 125569  115123    3092]
 [  87363  266520   94942]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5734544273284491 | macro 0.4198894704351346
[DEBUG] MaskedIoU per class [0.83128983 0.21829273 0.21008586]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  85%|████████▍ | 11/13 [02:19<00:26, 13.33s/it][DEBUG] CM: [[1160250    9846      55]
 [  81042  119476    2815]
 [ 137352  287170   45086]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5610348560074397 | macro 0.38993225600778003
[DEBUG] MaskedIoU per class [0.83558689 0.23878533 0.09542455]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  92%|█████████▏| 12/13 [02:31<00:13, 13.02s/it][DEBUG] CM: [[583331   9942     13]
 [ 36427  59181   2497]
 [ 52503 130196  47477]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5983540664877357 | macro 0.4358327322949183
[DEBUG] MaskedIoU per class [0.85505324 0.24840604 0.20403892]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing: 100%|██████████| 13/13 [02:37<00:00, 10.94s/it][DEBUG] CM - tensor([[14081535,   303569,     9957],
        [ 1470727,  1722199,   107027],
        [ 1169175,  3061133,  1112837]])
[INFO] CM IoU - tensor([82.6625, 25.8408, 20.3811])
[INFO] precision tensor([84.2125, 33.8556, 90.4877], dtype=torch.float64) (69.51858632870534) | recall tensor([97.8220, 52.1886, 20.8274], dtype=torch.float64) (56.94598660230383)
Testing: 100%|██████████| 13/13 [02:37<00:00, 12.13s/it]
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'acc': 0.7342848777770996,
 'cm': 0.0,
 'dist_l1': 0.09630932658910751,
 'dist_l2': 0.14446398615837097,
 'test_iou': 0.5803847312927246}
--------------------------------------------------------------------------------
