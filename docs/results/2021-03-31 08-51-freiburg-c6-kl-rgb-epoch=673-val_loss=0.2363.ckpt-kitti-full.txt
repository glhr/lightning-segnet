[W Context.cpp:69] Warning: torch.set_deterministic is in beta, and its design and  functionality may change in the future. (function operator())
Global seed set to 2
[WARNING] modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] kitti - train 200 | val 200 | test 200
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[INFO] SORD ranks: [0 1 2 3 4 5]
[INFO] SORD using L1 distance
[INFO] SORD ranks: [0 1 2 3 4 5]
[INFO] SORD using L1 distance
/home/robotlab/rob10/learning-driveability-heatmaps/models/pytorch-unet-segnet/env/lib/python3.6/site-packages/torch/nn/_reduction.py:44: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
[INFO] Distance ranks [0, 1, 2]
[INFO] Distances: mistakes from 1 to 2
[INFO] IoU labels: [0, 1, 2, 3, 4, 5]
[INFO] Confusion matrix labels: [0, 1, 2]
[INFO] IoU labels: [0, 1, 2]
[INFO] 2021-04-05 22-24-kitti-c6-kl-0,1,2-rgb
[WARNING] Testing phase
GPU available: False, used: False
TPU available: None, using: 0 TPU cores
Global seed set to 2
[WARNING] modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] dataset modalities ['rgb']
[WARNING] kitti - train 200 | val 200 | test 200
[WARNING] dataset modalities ['rgb']
[DEBUG] freiburg - class to idx: {'void': -1, 'road': 0, 'grass': 1, 'vegetation': 2, 'tree': 3, 'sky': 4, 'obstacle': 5}
[DEBUG] freiburg - color to idx: dict_values([-1, 0, 1, 2, 3, 4, 5])
[INFO] SORD ranks: [0 1 2 3 4 5]
[INFO] SORD using L1 distance
[INFO] SORD ranks: [0 1 2 3 4 5]
[INFO] SORD using L1 distance
[INFO] Distance ranks [0, 1, 2]
[INFO] Distances: mistakes from 1 to 2
[INFO] IoU labels: [0, 1, 2, 3, 4, 5]
[INFO] Confusion matrix labels: [0, 1, 2]
[INFO] IoU labels: [0, 1, 2]
[INFO] 2021-04-05 22-24-kitti-c6-kl-0,1,2-rgb
Namespace(augment=False, bs=16, dataset='kitti', debug=True, dist='l1', full_dataset=True, gpus=0, loss='kl', loss_weight=False, lr=None, max_epochs=1000, modalities='rgb', mode='convert', momentum=None, num_classes=6, optim=None, orig_dataset='freiburg', prefix=None, ranks='0,1,2', save=False, test_checkpoint='lightning_logs/2021-03-31 08-51-freiburg-c6-kl-rgb-epoch=673-val_loss=0.2363.ckpt', test_samples=None, train=False, train_checkpoint='lightning_logs/last.ckpt', update_output_layer=False, viz=False, workers=10)
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
2021-04-05 22-24-kitti-c6-kl-0,1,2-rgb
b221-999 ../../datasets/freiburg-forest/freiburg_forest_multispectral_annotated/freiburg_forest_annotated/test
Testing: 0it [00:00, ?it/s][DEBUG] CM: [[1094895   44108     477]
 [  73680  155280   24027]
 [  48893  296922  104495]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5811829331704195 | macro 0.449677679868904
[DEBUG] MaskedIoU per class [0.86755073 0.26140666 0.22007565]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:   8%|▊         | 1/13 [00:14<02:59, 14.92s/it][DEBUG] CM: [[1070932   34385    4305]
 [ 103869  166564   10961]
 [  52192  271599  128345]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 1 1 0]
[DEBUG] MaskedIoU micro 0.5886071012552236 | macro 0.4680980390027633
[DEBUG] MaskedIoU per class [0.84612972 0.28357208 0.27459232]
[DEBUG] L1 distance tensor([2., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000])
Testing:  15%|█▌        | 2/13 [00:26<02:24, 13.15s/it][DEBUG] CM: [[1077063   27199     808]
 [ 109688  202556    8857]
 [  56087  239634  121282]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 2 2 2], pred [0 0 0 ... 2 1 1]
[DEBUG] MaskedIoU micro 0.6129658661959783 | macro 0.49209755544131156
[DEBUG] MaskedIoU per class [0.8475172  0.34452166 0.2842538 ]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  23%|██▎       | 3/13 [00:38<02:05, 12.57s/it][DEBUG] CM: [[1093537   42767    1523]
 [  99130  151621   10854]
 [  71408  267941  104369]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5775173711781162 | macro 0.4431875504395831
[DEBUG] MaskedIoU per class [0.83580423 0.26492671 0.22883171]
[DEBUG] L1 distance tensor([1., 1., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.0000, 0.0000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.0000, 0.0000, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  31%|███       | 4/13 [00:51<01:54, 12.71s/it][DEBUG] CM: [[1099487   47333     327]
 [  96417  232783   13210]
 [  44525  185912  123018]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.6523802009740283 | macro 0.5310551898339825
[DEBUG] MaskedIoU per class [0.85357999 0.40437936 0.33520622]
[DEBUG] L1 distance tensor([2., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.0000, 0.0000,  ..., 0.0000, 0.0000, 0.0000])
Testing:  38%|███▊      | 5/13 [01:04<01:41, 12.75s/it][DEBUG] CM: [[1090615   61926    1033]
 [  73101  179267   25491]
 [  46715  199244  165515]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 0 0 0], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.6378360099483784 | macro 0.5223098694183779
[DEBUG] MaskedIoU per class [0.85646581 0.33257394 0.37788985]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  46%|████▌     | 6/13 [01:16<01:27, 12.44s/it][DEBUG] CM: [[1139596   52030    1788]
 [  52629  120522   16249]
 [  58902  266545  134933]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.6088371112586233 | macro 0.4641969052646058
[DEBUG] MaskedIoU per class [0.87329045 0.23725971 0.28204056]
[DEBUG] L1 distance tensor([1., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.0000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.0000, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  54%|█████▍    | 7/13 [01:28<01:13, 12.23s/it][DEBUG] CM: [[1117732   62473    1442]
 [  89228  152295   17985]
 [  57698  187463  156831]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 0 0]
[DEBUG] MaskedIoU micro 0.6315106955895188 | macro 0.5041320077074081
[DEBUG] MaskedIoU per class [0.84130266 0.29894355 0.37214981]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  62%|██████▏   | 8/13 [01:39<01:00, 12.10s/it][DEBUG] CM: [[1102627   54960     876]
 [  88341  188019    5984]
 [  46537  234216  121255]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.6209627444607515 | macro 0.49269497123143985
[DEBUG] MaskedIoU per class [0.8525416  0.32898061 0.2965627 ]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  69%|██████▉   | 9/13 [01:52<00:49, 12.34s/it][DEBUG] CM: [[1129429   25489      50]
 [ 106675  155779   23669]
 [  90447  227868   83745]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5907409716879072 | macro 0.44025503672053407
[DEBUG] MaskedIoU per class [0.83532087 0.28875769 0.19668654]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing:  77%|███████▋  | 10/13 [02:05<00:37, 12.45s/it][DEBUG] CM: [[1111845   38327     240]
 [  93526  145560    4698]
 [  56231  263761  128833]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.6027635398494828 | macro 0.46857715870078415
[DEBUG] MaskedIoU per class [0.85515421 0.26665592 0.28392134]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  85%|████████▍ | 11/13 [02:17<00:24, 12.31s/it][DEBUG] CM: [[1141054   28383     714]
 [  59316  139822    4195]
 [  96258  295502   77848]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.5837797427238277 | macro 0.4299888028952801
[DEBUG] MaskedIoU per class [0.86070188 0.26520718 0.16405735]
[DEBUG] L1 distance tensor([1., 1., 1.,  ..., 1., 1., 1.]) | L2 distance tensor([1., 1., 1.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0., 0., 0.,  ..., 0., 0., 0.]) | L2 distance tensor([0., 0., 0.,  ..., 0., 0., 0.])
Testing:  92%|█████████▏| 12/13 [02:29<00:12, 12.15s/it][DEBUG] CM: [[574358  18901     27]
 [ 24316  70522   3267]
 [ 31930 124025  74221]]
[DEBUG] MaskedIoU inputs: target [0 0 0 ... 1 1 1], pred [0 0 0 ... 1 1 1]
[DEBUG] MaskedIoU micro 0.6397507902348063 | macro 0.49825097770187116
[DEBUG] MaskedIoU per class [0.88426436 0.29258477 0.3179038 ]
[DEBUG] L1 distance tensor([2., 2., 2.,  ..., 1., 1., 1.]) | L2 distance tensor([4., 4., 4.,  ..., 1., 1., 1.])
[DEBUG] L1 distance tensor([0.5000, 0.5000, 0.5000,  ..., 0.0000, 0.0000, 0.0000]) | L2 distance tensor([0.7500, 0.7500, 0.7500,  ..., 0.0000, 0.0000, 0.0000])
Testing: 100%|██████████| 13/13 [02:35<00:00, 10.28s/it][DEBUG] CM - tensor([[13843170,   538281,    13610],
        [ 1069916,  2060590,   169447],
        [  757823,  3060632,  1524690]])
[INFO] CM IoU - tensor([85.3316, 29.8685, 27.5902])
[INFO] precision tensor([88.3367, 36.4094, 89.2808], dtype=torch.float64) (71.34230382711357) | recall tensor([96.1661, 62.4430, 28.5354], dtype=torch.float64) (62.38152055131726)
Testing: 100%|██████████| 13/13 [02:35<00:00, 11.95s/it]
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'acc': 0.7565035820007324,
 'cm': 0.0,
 'dist_l1': 0.06875873357057571,
 'dist_l2': 0.10313810408115387,
 'test_iou': 0.6087167859077454}
--------------------------------------------------------------------------------
